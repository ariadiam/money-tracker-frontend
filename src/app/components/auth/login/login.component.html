<div class="auth-page">
  <div class="card">
    <div class="card-header">
      <h1>Sign in</h1>
      <p class="sub">Welcome back! Please enter your details.</p>
    </div>

    <form [formGroup]="loginForm" (ngSubmit)="onSubmit()" novalidate class="form">
      <div class="form-control" [class.invalid]="u?.touched && u?.invalid">
        <label for="username">Username</label>
        <input
          id="username"
          type="text"
          formControlName="username"
          placeholder="yourusername"
          autocomplete="username"
          aria-describedby="usernameHelp"
        />
        <small id="usernameHelp" *ngIf="u?.touched && u?.hasError('required')">
          Username is required.
        </small>
      </div>

      <div class="form-control" [class.invalid]="p?.touched && p?.invalid">
        <label for="password">Password</label>
        <div class="password-wrap">
          <input
            id="password"
            [type]="showPassword ? 'text' : 'password'"
            formControlName="password"
            placeholder="••••••••"
            autocomplete="current-password"
            aria-describedby="passwordHelp"
          />
          <button
            type="button"
            class="icon-btn"
            (click)="togglePassword()"
            [attr.aria-pressed]="showPassword"
            aria-label="Toggle password visibility"
          >
            {{ showPassword ? 'Hide' : 'Show' }}
          </button>
        </div>
        <small id="passwordHelp" *ngIf="p?.touched && p?.hasError('required')">
          Password is required.
        </small>
        <small id="passwordHelp" *ngIf="p?.touched && p?.hasError('minlength')">
          Password must be at least 4 characters.
        </small>
      </div>

      <div class="form-row">
        <label class="checkbox">
          <input type="checkbox" formControlName="remember" />
          <span>Remember me</span>
        </label>
        <a class="link" href="#" (click)="$event.preventDefault()">Forgot password?</a>
      </div>

      <button
        class="primary"
        type="submit"
        [disabled]="loginForm.invalid || isSubmitting"
      >
        <span *ngIf="!isSubmitting">Sign in</span>
        <span *ngIf="isSubmitting" class="spinner"></span>
      </button>

      <p class="error" *ngIf="errorMessage">{{ errorMessage }}</p>

      <div class="divider"><span>or</span></div>

      <button
        type="button"
        class="google"
        (click)="redirectToGoogle()"
      >
        <img src="https://www.gstatic.com/images/branding/product/1x/googleg_32dp.png" alt="" />
        Continue with Google
      </button>

      <p class="meta">
        Don’t have an account? <a class="link" routerLink="/register">Create one</a>
      </p>
    </form>
  </div>
</div>
